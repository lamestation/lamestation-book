#### Making Maps With Tiled

![](attachments/8749106/8847389.png)

In this tutorial, we show you how to create your own level maps using the
Tiled tile editor. It's a popular editor, is well-maintained, and has some
pretty nifty features like the terrain brush.

  * Step 1: Installation 
  * Step 2: Create A New Map 
  * Step 3: Add A Tileset 
  * Step 4: Draw Some Terrain 
  * Step 5: Set Map Properties 
  * Step 6: Convert With map2dat 
  * Step 7: Make A Collision Map 

#####  Step 1: Installation

######  Windows and Mac

Download a version of Tiled for your operating system at [ mapeditor.org
](http://www.mapeditor.org/) and install it.

######  Debian Linux

Get it from the package manager.

    
    
    sudo apt-get install tiled

#####  Step 2: Create A New Map

I have written a utility called map2dat that can take Tiled TMX files and
convert them into data blocks usable by LameGFX, so let's create a level in
Tiled. Go to "File -&gt; New..." in the menu.

![](attachments/8749106/8847401.png)

This level can be whatever size you like, within reason; a 100x100 level will
consume 10kB of memory when loaded, and a 200x200 level won't even fit in the
Propeller memory! I selected 10x10 for this demonstration. The LameTile
library expects 8x8 tiles, so select that for tile size. Tiled provides an
option for isometric maps, which maybe someday the LameStation will support,
but in the near future, the only orientation you'll need is Orthogonal.

#####  Step 3: Add A Tileset

You should have a nice empty map in front of you now; let's fill it up! But
hey, there's no tiles to use. Let's add a tileset. Go to "Map -&gt; New
Tileset..." and find a nice tileset; you can use the ` tiles_2b_poketron.png
` tileset in ` LAMESDK/tilemaps ` . Select 255,0,255 as the transparent color
(it should be the default).

![](attachments/8749106/8847402.png)

#####  Step 4: Draw Some Terrain

You can also try out a predefined external tileset that has terrain brushes
defined. These terrain brushes are awesome; they allow you to paint on
textures that have predefined relationships to surrounding tiles, which is
perfect when you're trying to paint water into field, or dirt into a rock
formation, hence "Terrain brushes." I'm going to do it this way, because it's
a lot more fun.

![](attachments/8749106/8847403.png)

#####  Step 5: Set Map Properties

Cool, you've made your fancy level; now we're gona save it.

Open " _ Map -&gt; Map Properties _ ". There are two things to set here:

  * The Background color should be set to #FF00FF. The default gray color will blend in with black and white tiles and be hard to see. 
  * The Layer format should be set to " ` CSV ` ". The default compression is not supported by ` map2dat ` yet. 

![](attachments/8749106/8847390.png)

#####  Step 6: Convert With map2dat

Once your level is saved, open up the command line and run map2dat on the
level you made.

    
    
    $ ./map2dat maps/tinywhatever.tmx

You should see an output similar to the following.

This output is broken into three parts. The first part is a single line that
contains the label for the level ` map_tinything ` . This is actually a list
of levels that correspond to this tilemap, automatically sorted by map2dat in
case not every level passed on the command line uses the same tilemap. This
piece of information is a file table that simplifies loading and managing
levels. This allows map2dat to generate level packs that can be copied into a
game and only a single address reference needs to be updated to use the whole
new collection of levels.

The second part is the data block rendering of the tilemap used to create the
level; this output is the same as running img2dat on the tilemap with the -m
block option.

The final part is the level itself, with a one-line header indicating the size
of the level.

#####  Step 7: Make A Collision Map

Levels are encoded in the data blocks by making the most significant bit a
collision bit, while the rest hold the tile number. This limits the number of
tiles a level can access to 128.

|  ![](attachments/8749106/8847405.png)  
---  
  
To create your own collision map, create an image the same size as your
tilemap and color over tiles that should not be walkable in black, while
walkable tiles are in white. When you run map2dat on a tilemap, it
automatically searches for a collision map the same name as the tilemap but
with ` _collision ` added before the file extension. So if your tilemap is
named ` foobar.png ` , ` map2dat ` will look for a collision map named `
foobar_collision.png ` and attempt to process it into your level output.

![](attachments/8749106/13893661.png) ![](attachments/8749106/13893660.png)
![](attachments/8749106/13893659.png)

Then pass it on to map2dat.

