== A New Direction

The snake is always moving in one direction, and we need to remember which direction that is.

An easy way to do that is by assigning a number to each direction. Because we're sane human beings, let's come up with a scheme that's easy to remember. Let's use a compass as a reference, and assign 0 to North, 1 to East, 2 to South, and 3 to West.

image:compass.png[]

We can then create constants to make working with direction easier.

----
CON
    UP    = 0
    RIGHT = 1
    DOWN  = 2
    LEFT  = 3
----

Now we gotta track that number in a variable. There are only four directions, so byte-sized is plenty large.

----
VAR    
    byte    snakedir
----

Let's experiment with using direction. In the last exercise, we directly controlled the snake with LameControl.

----
        if ctrl.Left and snakex > 0
            snakex--
        if ctrl.Right and snakex < constant(128-2)
            snakex++
        if ctrl.Up and snakey > 0
            snakey--
        if ctrl.Down and snakey < constant(64-2)
            snakey++
----

We're going to change that code a lot. We will control only the _direction_ with LameControl, and then have the movement code look at `snakedir` only to decide how the snake should move.

----
        if ctrl.Up
            snakedir := UP
        if ctrl.Right
            snakedir := RIGHT
        if ctrl.Down
            snakedir := DOWN
        if ctrl.Left
            snakedir := LEFT
            
        if snakedir == LEFT and snakex > 0
            snakex--
        if snakedir == RIGHT and snakex < constant(128-2)
            snakex++
        if snakedir == UP and snakey > 0
            snakey--
        if snakedir == DOWN and snakey < constant(64-2)
            snakey++
----

The first thing you'll notice is that now the dot seems to have a mind of its own! This is because we programmed it to move if it has a direction, and it always does.

All in all, the snake is looking pretty good... for a single dot. There's one more thing we need to add to really move like a snake. You'll notice that if you are moving in one direction, you can go in the exact opposite direction, which the snake shouldn't be able to do.

We'll add code to prevent that.

----
        if snakedir == LEFT or snakedir == RIGHT
            if ctrl.Up
                snakedir := UP
            if ctrl.Down
                snakedir := DOWN
                
        elseif snakedir == DOWN or snakedir == UP
            if ctrl.Left
                snakedir := LEFT
            if ctrl.Right
                snakedir := RIGHT
----

This code lets you go up/down if you're heading left/right, and vice versa, but you can't do U-turns. It's a small change, but an important part of what makes snake difficult.